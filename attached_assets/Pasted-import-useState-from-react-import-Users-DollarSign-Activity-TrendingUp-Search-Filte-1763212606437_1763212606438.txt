import { useState } from 'react';
import { 
  Users, DollarSign, Activity, TrendingUp, Search, Filter, Download,
  Settings, BarChart3, Zap, Database, AlertCircle, CheckCircle, XCircle,
  Clock, Mail, Phone, Calendar, CreditCard, Eye, Ban, UserCheck, Shield,
  RefreshCw, FileText, Bell, Package, Server, Code, Link, Wifi, WifiOff,
  ChevronDown
} from 'lucide-react';

interface AdminScreenEnhancedProps {
  isDark: boolean;
  onClose: () => void;
}

// Mock data for demonstration
const MOCK_USERS = [
  {
    id: 'U001',
    name: 'Sarah Johnson',
    email: 'sarah.j@email.com',
    phone: '+1 (555) 123-4567',
    joined: '2024-01-15',
    lastActive: '2025-11-13',
    subscription: 'Premium',
    status: 'active',
    role: 'user',
    biomarkers: 47,
    aiQueries: 156,
    revenue: 299.88
  },
  {
    id: 'U002',
    name: 'Michael Chen',
    email: 'mchen@email.com',
    phone: '+1 (555) 234-5678',
    joined: '2024-03-22',
    lastActive: '2025-11-12',
    subscription: 'Basic',
    status: 'active',
    role: 'user',
    biomarkers: 23,
    aiQueries: 67,
    revenue: 119.88
  },
  {
    id: 'U003',
    name: 'Emily Rodriguez',
    email: 'emily.r@email.com',
    phone: '+1 (555) 345-6789',
    joined: '2024-06-10',
    lastActive: '2025-10-28',
    subscription: 'Free',
    status: 'inactive',
    role: 'user',
    biomarkers: 8,
    aiQueries: 12,
    revenue: 0
  },
  {
    id: 'U004',
    name: 'David Park',
    email: 'dpark@email.com',
    phone: '+1 (555) 456-7890',
    joined: '2024-08-05',
    lastActive: '2025-11-13',
    subscription: 'Premium',
    status: 'active',
    role: 'admin',
    biomarkers: 62,
    aiQueries: 234,
    revenue: 299.88
  },
  {
    id: 'U005',
    name: 'Lisa Thompson',
    email: 'lisa.t@email.com',
    phone: '+1 (555) 567-8901',
    joined: '2024-09-18',
    lastActive: '2025-11-11',
    subscription: 'Basic',
    status: 'suspended',
    role: 'user',
    biomarkers: 15,
    aiQueries: 34,
    revenue: 119.88
  },
];

const API_USAGE_DATA = [
  { date: '2025-11-13', queries: 1247, cost: 124.70, model: 'GPT-4', avgLatency: 1.2 },
  { date: '2025-11-12', queries: 1189, cost: 118.90, model: 'GPT-4', avgLatency: 1.3 },
  { date: '2025-11-11', queries: 1034, cost: 103.40, model: 'GPT-4', avgLatency: 1.1 },
  { date: '2025-11-10', queries: 876, cost: 87.60, model: 'GPT-4', avgLatency: 1.4 },
  { date: '2025-11-09', queries: 1312, cost: 131.20, model: 'GPT-4', avgLatency: 1.2 },
  { date: '2025-11-08', queries: 1456, cost: 145.60, model: 'GPT-4', avgLatency: 1.1 },
  { date: '2025-11-07', queries: 1523, cost: 152.30, model: 'GPT-4', avgLatency: 1.3 },
];

const REVENUE_DATA = [
  { month: 'May', revenue: 12450, users: 156, churn: 3.2 },
  { month: 'Jun', revenue: 15780, users: 189, churn: 2.8 },
  { month: 'Jul', revenue: 18920, users: 234, churn: 2.1 },
  { month: 'Aug', revenue: 22340, users: 278, churn: 1.9 },
  { month: 'Sep', revenue: 26780, users: 312, churn: 1.5 },
  { month: 'Oct', revenue: 31240, users: 367, churn: 1.2 },
  { month: 'Nov', revenue: 35890, users: 423, churn: 1.1 },
];

const SYSTEM_LOGS = [
  { time: '2025-11-13 14:32:15', event: 'User Registration', user: 'john.doe@email.com', status: 'success' },
  { time: '2025-11-13 14:28:42', event: 'Payment Processed', user: 'sarah.j@email.com', status: 'success' },
  { time: '2025-11-13 14:15:33', event: 'API Rate Limit', user: 'system', status: 'warning' },
  { time: '2025-11-13 13:57:21', event: 'Failed Login Attempt', user: 'unknown@email.com', status: 'error' },
  { time: '2025-11-13 13:42:18', event: 'Subscription Upgrade', user: 'mchen@email.com', status: 'success' },
  { time: '2025-11-13 13:28:55', event: 'Data Export', user: 'admin@flo.com', status: 'success' },
];

export function AdminScreenEnhanced({ isDark, onClose }: AdminScreenEnhancedProps) {
  const [activeTab, setActiveTab] = useState<'overview' | 'users' | 'billing' | 'api' | 'analytics' | 'settings' | 'logs'>('overview');
  const [searchQuery, setSearchQuery] = useState('');
  const [selectedFilter, setSelectedFilter] = useState<'all' | 'active' | 'inactive' | 'suspended'>('all');
  const [selectedUser, setSelectedUser] = useState<typeof MOCK_USERS[0] | null>(null);

  // Calculate overview metrics
  const totalUsers = MOCK_USERS.length;
  const activeUsers = MOCK_USERS.filter(u => u.status === 'active').length;
  const totalRevenue = MOCK_USERS.reduce((sum, u) => sum + u.revenue, 0);
  const totalApiCost = API_USAGE_DATA.reduce((sum, d) => sum + d.cost, 0);
  const totalApiQueries = API_USAGE_DATA.reduce((sum, d) => sum + d.queries, 0);
  const avgQueryCost = totalApiQueries > 0 ? totalApiCost / totalApiQueries : 0;

  // Filter users
  const filteredUsers = MOCK_USERS.filter(user => {
    const matchesSearch = user.name.toLowerCase().includes(searchQuery.toLowerCase()) ||
                         user.email.toLowerCase().includes(searchQuery.toLowerCase());
    const matchesFilter = selectedFilter === 'all' || user.status === selectedFilter;
    return matchesSearch && matchesFilter;
  });

  const tabs = [
    { id: 'overview', label: 'Overview', icon: BarChart3 },
    { id: 'users', label: 'Users', icon: Users },
    { id: 'billing', label: 'Billing', icon: DollarSign },
    { id: 'api', label: 'API Usage', icon: Zap },
    { id: 'analytics', label: 'Analytics', icon: TrendingUp },
    { id: 'logs', label: 'Audit Logs', icon: FileText },
    { id: 'settings', label: 'Settings', icon: Settings },
  ];

  return (
    <div className={`fixed inset-0 z-50 overflow-hidden ${\n      isDark \n        ? 'bg-gradient-to-br from-slate-900 via-blue-950 to-slate-900' \n        : 'bg-gradient-to-br from-blue-50 via-teal-50 to-cyan-50'\n    }`}>\n      {/* Header */}\n      <div className={`sticky top-0 z-50 backdrop-blur-xl border-b ${\n        isDark ? 'bg-white/5 border-white/10' : 'bg-white/70 border-black/10'\n      }`}>\n        <div className=\"px-6 py-4\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-3\">\n              <Shield className={`w-6 h-6 ${isDark ? 'text-cyan-400' : 'text-cyan-600'}`} />\n              <div>\n                <h1 className={`text-xl ${isDark ? 'text-white' : 'text-gray-900'}`}>\n                  Admin Dashboard\n                </h1>\n                <p className={`text-xs ${isDark ? 'text-white/50' : 'text-gray-500'}`}>\n                  Flō by Nuvitae Labs - Administrative Control Panel\n                </p>\n              </div>\n            </div>\n            <button \n              onClick={onClose}\n              className={`px-4 py-2 rounded-lg transition-colors ${\n                isDark ? 'hover:bg-white/10 text-white/70' : 'hover:bg-black/5 text-gray-600'\n              }`}\n            >\n              Close\n            </button>\n          </div>\n        </div>

        {/* Tab Navigation */}
        <div className=\"px-6 pb-2\">\n          <div className=\"flex gap-2 overflow-x-auto scrollbar-hide\">\n            {tabs.map(tab => {\n              const Icon = tab.icon;\n              return (\n                <button\n                  key={tab.id}\n                  onClick={() => setActiveTab(tab.id as any)}\n                  className={`flex items-center gap-2 px-4 py-2 rounded-lg whitespace-nowrap transition-all text-sm ${\n                    activeTab === tab.id\n                      ? 'bg-gradient-to-r from-teal-500 via-cyan-500 to-blue-500 text-white shadow-lg'\n                      : isDark\n                        ? 'bg-white/5 text-white/70 hover:bg-white/10'\n                        : 'bg-white/60 text-gray-700 hover:bg-white/80'\n                  }`}\n                >\n                  <Icon className=\"w-4 h-4\" />\n                  {tab.label}\n                </button>\n              );\n            })}\n          </div>\n        </div>\n      </div>

      {/* Content */}\n      <div className=\"h-[calc(100vh-140px)] overflow-y-auto px-6 py-6\">\n        {/* Overview Tab */}\n        {activeTab === 'overview' && (\n          <div className=\"space-y-6\">\n            {/* Key Metrics */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n              <div className={`rounded-2xl p-6 border ${\n                isDark ? 'bg-white/5 border-white/10' : 'bg-white/60 border-gray-200'\n              }`}>\n                <div className=\"flex items-center justify-between mb-4\">\n                  <Users className={`w-8 h-8 ${isDark ? 'text-cyan-400' : 'text-cyan-600'}`} />\n                  <span className={`text-xs px-2 py-1 rounded-full ${\n                    isDark ? 'bg-green-500/20 text-green-400' : 'bg-green-100 text-green-700'\n                  }`}>\n                    +12% this month\n                  </span>\n                </div>\n                <div className={`text-3xl mb-1 ${isDark ? 'text-white' : 'text-gray-900'}`}>\n                  {totalUsers}\n                </div>\n                <div className={`text-sm ${isDark ? 'text-white/50' : 'text-gray-600'}`}>\n                  Total Users\n                </div>\n                <div className={`text-xs mt-2 ${isDark ? 'text-white/40' : 'text-gray-500'}`}>\n                  {activeUsers} active users\n                </div>\n              </div>

              <div className={`rounded-2xl p-6 border ${\n                isDark ? 'bg-white/5 border-white/10' : 'bg-white/60 border-gray-200'\n              }`}>\n                <div className=\"flex items-center justify-between mb-4\">\n                  <DollarSign className={`w-8 h-8 ${isDark ? 'text-green-400' : 'text-green-600'}`} />\n                  <span className={`text-xs px-2 py-1 rounded-full ${\n                    isDark ? 'bg-green-500/20 text-green-400' : 'bg-green-100 text-green-700'\n                  }`}>\n                    +15% MoM\n                  </span>\n                </div>\n                <div className={`text-3xl mb-1 ${isDark ? 'text-white' : 'text-gray-900'}`}>\n                  ${totalRevenue.toFixed(2)}\n                </div>\n                <div className={`text-sm ${isDark ? 'text-white/50' : 'text-gray-600'}`}>\n                  Total Revenue\n                </div>\n                <div className={`text-xs mt-2 ${isDark ? 'text-white/40' : 'text-gray-500'}`}>\n                  $35,890 projected Nov\n                </div>\n              </div>

              <div className={`rounded-2xl p-6 border ${\n                isDark ? 'bg-white/5 border-white/10' : 'bg-white/60 border-gray-200'\n              }`}>\n                <div className=\"flex items-center justify-between mb-4\">\n                  <Zap className={`w-8 h-8 ${isDark ? 'text-purple-400' : 'text-purple-600'}`} />\n                  <span className={`text-xs px-2 py-1 rounded-full ${\n                    isDark ? 'bg-amber-500/20 text-amber-400' : 'bg-amber-100 text-amber-700'\n                  }`}>\n                    7 days\n                  </span>\n                </div>\n                <div className={`text-3xl mb-1 ${isDark ? 'text-white' : 'text-gray-900'}`}>\n                  {totalApiQueries.toLocaleString()}\n                </div>\n                <div className={`text-sm ${isDark ? 'text-white/50' : 'text-gray-600'}`}>\n                  API Queries\n                </div>\n                <div className={`text-xs mt-2 ${isDark ? 'text-white/40' : 'text-gray-500'}`}>\n                  ${avgQueryCost.toFixed(4)} avg cost\n                </div>\n              </div>

              <div className={`rounded-2xl p-6 border ${\n                isDark ? 'bg-white/5 border-white/10' : 'bg-white/60 border-gray-200'\n              }`}>\n                <div className=\"flex items-center justify-between mb-4\">\n                  <Activity className={`w-8 h-8 ${isDark ? 'text-blue-400' : 'text-blue-600'}`} />\n                  <span className={`text-xs px-2 py-1 rounded-full ${\n                    isDark ? 'bg-red-500/20 text-red-400' : 'bg-red-100 text-red-700'\n                  }`}>\n                    -$18.50\n                  </span>\n                </div>\n                <div className={`text-3xl mb-1 ${isDark ? 'text-white' : 'text-gray-900'}`}>\n                  ${totalApiCost.toFixed(2)}\n                </div>\n                <div className={`text-sm ${isDark ? 'text-white/50' : 'text-gray-600'}`}>\n                  AI API Costs\n                </div>\n                <div className={`text-xs mt-2 ${isDark ? 'text-white/40' : 'text-gray-500'}`}>\n                  Last 7 days\n                </div>\n              </div>\n            </div>

            {/* System Integrations & Health */}\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n              {/* System Integrations */}\n              <div className={`rounded-2xl p-6 border ${\n                isDark ? 'bg-white/5 border-white/10' : 'bg-white/60 border-gray-200'\n              }`}>\n                <h3 className={`text-lg mb-4 flex items-center gap-2 ${isDark ? 'text-white' : 'text-gray-900'}`}>\n                  <Link className=\"w-5 h-5\" />\n                  System Integrations\n                </h3>\n                <div className=\"space-y-3\">\n                  {/* Supabase Database */}\n                  <div className={`p-3 rounded-xl border ${\n                    isDark ? 'bg-white/5 border-white/10' : 'bg-white border-gray-200'\n                  }`}>\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <div className=\"flex items-center gap-2\">\n                        <Database className={`w-4 h-4 ${isDark ? 'text-green-400' : 'text-green-600'}`} />\n                        <span className={`text-sm ${isDark ? 'text-white' : 'text-gray-900'}`}>\n                          Supabase Database\n                        </span>\n                      </div>\n                      <div className=\"flex items-center gap-2\">\n                        <Wifi className=\"w-3 h-3 text-green-500\" />\n                        <span className=\"text-xs text-green-500\">Connected</span>\n                      </div>\n                    </div>\n                    <div className={`text-xs ${isDark ? 'text-white/50' : 'text-gray-500'}`}>\n                      Last checked: 2 min ago • Response: 45ms\n                    </div>\n                  </div>

                  {/* OpenAI API */}\n                  <div className={`p-3 rounded-xl border ${\n                    isDark ? 'bg-white/5 border-white/10' : 'bg-white border-gray-200'\n                  }`}>\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <div className=\"flex items-center gap-2\">\n                        <Zap className={`w-4 h-4 ${isDark ? 'text-purple-400' : 'text-purple-600'}`} />\n                        <span className={`text-sm ${isDark ? 'text-white' : 'text-gray-900'}`}>\n                          OpenAI API (GPT-4)\n                        </span>\n                      </div>\n                      <div className=\"flex items-center gap-2\">\n                        <Wifi className=\"w-3 h-3 text-green-500\" />\n                        <span className=\"text-xs text-green-500\">Active</span>\n                      </div>\n                    </div>\n                    <div className={`text-xs ${isDark ? 'text-white/50' : 'text-gray-500'}`}>\n                      Last query: 5 sec ago • Avg latency: 1.2s\n                    </div>\n                  </div>

                  {/* Stripe Integration */}\n                  <div className={`p-3 rounded-xl border ${\n                    isDark ? 'bg-white/5 border-white/10' : 'bg-white border-gray-200'\n                  }`}>\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <div className=\"flex items-center gap-2\">\n                        <CreditCard className={`w-4 h-4 ${isDark ? 'text-blue-400' : 'text-blue-600'}`} />\n                        <span className={`text-sm ${isDark ? 'text-white' : 'text-gray-900'}`}>\n                          Stripe Payments\n                        </span>\n                      </div>\n                      <div className=\"flex items-center gap-2\">\n                        <Wifi className=\"w-3 h-3 text-green-500\" />\n                        <span className=\"text-xs text-green-500\">Operational</span>\n                      </div>\n                    </div>\n                    <div className={`text-xs ${isDark ? 'text-white/50' : 'text-gray-500'}`}>\n                      Webhook verified • Last payment: 3 min ago\n                    </div>\n                  </div>

                  {/* Authentication Service */}\n                  <div className={`p-3 rounded-xl border ${\n                    isDark ? 'bg-white/5 border-white/10' : 'bg-white border-gray-200'\n                  }`}>\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <div className=\"flex items-center gap-2\">\n                        <Shield className={`w-4 h-4 ${isDark ? 'text-cyan-400' : 'text-cyan-600'}`} />\n                        <span className={`text-sm ${isDark ? 'text-white' : 'text-gray-900'}`}>\n                          Auth Service\n                        </span>\n                      </div>\n                      <div className=\"flex items-center gap-2\">\n                        <Wifi className=\"w-3 h-3 text-green-500\" />\n                        <span className=\"text-xs text-green-500\">Healthy</span>\n                      </div>\n                    </div>\n                    <div className={`text-xs ${isDark ? 'text-white/50' : 'text-gray-500'}`}>\n                      Last login: 1 min ago • {activeUsers} active sessions\n                    </div>\n                  </div>\n                </div>\n              </div>

              {/* System Health */}\n              <div className={`rounded-2xl p-6 border ${\n                isDark ? 'bg-white/5 border-white/10' : 'bg-white/60 border-gray-200'\n              }`}>\n                <h3 className={`text-lg mb-4 flex items-center gap-2 ${isDark ? 'text-white' : 'text-gray-900'}`}>\n                  <Server className=\"w-5 h-5\" />\n                  System Health\n                </h3>\n                <div className=\"space-y-3\">\n                  <div className=\"flex items-center justify-between\">\n                    <span className={`text-sm ${isDark ? 'text-white/70' : 'text-gray-600'}`}>\n                      API Uptime\n                    </span>\n                    <div className=\"flex items-center gap-2\">\n                      <CheckCircle className=\"w-4 h-4 text-green-500\" />\n                      <span className={`text-sm ${isDark ? 'text-white' : 'text-gray-900'}`}>\n                        99.98%\n                      </span>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center justify-between\">\n                    <span className={`text-sm ${isDark ? 'text-white/70' : 'text-gray-600'}`}>\n                      Database Status\n                    </span>\n                    <div className=\"flex items-center gap-2\">\n                      <CheckCircle className=\"w-4 h-4 text-green-500\" />\n                      <span className={`text-sm ${isDark ? 'text-white' : 'text-gray-900'}`}>\n                        Healthy\n                      </span>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center justify-between\">\n                    <span className={`text-sm ${isDark ? 'text-white/70' : 'text-gray-600'}`}>\n                      Avg Response Time\n                    </span>\n                    <div className=\"flex items-center gap-2\">\n                      <CheckCircle className=\"w-4 h-4 text-green-500\" />\n                      <span className={`text-sm ${isDark ? 'text-white' : 'text-gray-900'}`}>\n                        124ms\n                      </span>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center justify-between\">\n                    <span className={`text-sm ${isDark ? 'text-white/70' : 'text-gray-600'}`}>\n                      Error Rate\n                    </span>\n                    <div className=\"flex items-center gap-2\">\n                      <AlertCircle className=\"w-4 h-4 text-amber-500\" />\n                      <span className={`text-sm ${isDark ? 'text-white' : 'text-gray-900'}`}>\n                        0.12%\n                      </span>\n                    </div>\n                  </div>\n                  <div className={`pt-3 mt-3 border-t ${isDark ? 'border-white/10' : 'border-gray-200'}`}>\n                    <button className={`w-full py-2 px-3 rounded-lg text-sm flex items-center justify-center gap-2 ${\n                      isDark ? 'bg-white/10 hover:bg-white/20 text-white' : 'bg-gray-200 hover:bg-gray-300 text-gray-900'\n                    }`}>\n                      <RefreshCw className=\"w-4 h-4\" />\n                      Refresh Status\n                    </button>\n                  </div>\n                </div>\n              </div>\n            </div>

            {/* Recent Activity */}\n            <div className={`rounded-2xl p-6 border ${\n              isDark ? 'bg-white/5 border-white/10' : 'bg-white/60 border-gray-200'\n            }`}>\n              <h3 className={`text-lg mb-4 flex items-center gap-2 ${isDark ? 'text-white' : 'text-gray-900'}`}>\n                <Bell className=\"w-5 h-5\" />\n                Recent Activity\n              </h3>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\n                {SYSTEM_LOGS.map((log, i) => (\n                  <div key={i} className=\"flex items-start gap-3\">\n                    {log.status === 'success' && <CheckCircle className=\"w-4 h-4 text-green-500 mt-0.5\" />}\n                    {log.status === 'warning' && <AlertCircle className=\"w-4 h-4 text-amber-500 mt-0.5\" />}\n                    {log.status === 'error' && <XCircle className=\"w-4 h-4 text-red-500 mt-0.5\" />}\n                    <div className=\"flex-1 min-w-0\">\n                      <div className={`text-sm ${isDark ? 'text-white' : 'text-gray-900'}`}>\n                        {log.event}\n                      </div>\n                      <div className={`text-xs ${isDark ? 'text-white/50' : 'text-gray-500'}`}>\n                        {log.user} • {log.time.split(' ')[1]}\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Users Tab */}\n        {activeTab === 'users' && (\n          <div className=\"space-y-4\">\n            {/* Search and Filters */}\n            <div className=\"flex flex-col sm:flex-row gap-3\">\n              <div className=\"flex-1 relative\">\n                <Search className={`absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 ${\n                  isDark ? 'text-white/40' : 'text-gray-400'\n                }`} />\n                <input\n                  type=\"text\"\n                  placeholder=\"Search users by name or email...\"\n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  className={`w-full pl-10 pr-4 py-2.5 rounded-xl border ${\n                    isDark \n                      ? 'bg-white/5 border-white/10 text-white placeholder-white/40' \n                      : 'bg-white border-gray-200 text-gray-900 placeholder-gray-400'\n                  }`}\n                />\n              </div>\n              <select\n                value={selectedFilter}\n                onChange={(e) => setSelectedFilter(e.target.value as any)}\n                className={`px-4 py-2.5 rounded-xl border ${\n                  isDark \n                    ? 'bg-white/5 border-white/10 text-white' \n                    : 'bg-white border-gray-200 text-gray-900'\n                }`}\n              >\n                <option value=\"all\">All Users</option>\n                <option value=\"active\">Active</option>\n                <option value=\"inactive\">Inactive</option>\n                <option value=\"suspended\">Suspended</option>\n              </select>\n              <button className={`px-4 py-2.5 rounded-xl flex items-center gap-2 ${\n                isDark ? 'bg-white/10 hover:bg-white/20 text-white' : 'bg-gray-200 hover:bg-gray-300 text-gray-900'\n              }`}>\n                <Download className=\"w-4 h-4\" />\n                Export\n              </button>\n            </div>

            {/* Users Table */}\n            <div className={`rounded-2xl border overflow-hidden ${\n              isDark ? 'bg-white/5 border-white/10' : 'bg-white/60 border-gray-200'\n            }`}>\n              <div className=\"overflow-x-auto\">\n                <table className=\"w-full\">\n                  <thead className={`border-b ${isDark ? 'border-white/10' : 'border-gray-200'}`}>\n                    <tr>\n                      <th className={`px-6 py-3 text-left text-xs ${isDark ? 'text-white/70' : 'text-gray-600'}`}>\n                        User\n                      </th>\n                      <th className={`px-6 py-3 text-left text-xs ${isDark ? 'text-white/70' : 'text-gray-600'}`}>\n                        Contact\n                      </th>\n                      <th className={`px-6 py-3 text-left text-xs ${isDark ? 'text-white/70' : 'text-gray-600'}`}>\n                        Subscription\n                      </th>\n                      <th className={`px-6 py-3 text-left text-xs ${isDark ? 'text-white/70' : 'text-gray-600'}`}>\n                        Role\n                      </th>\n                      <th className={`px-6 py-3 text-left text-xs ${isDark ? 'text-white/70' : 'text-gray-600'}`}>\n                        Status\n                      </th>\n                      <th className={`px-6 py-3 text-left text-xs ${isDark ? 'text-white/70' : 'text-gray-600'}`}>\n                        Activity\n                      </th>\n                      <th className={`px-6 py-3 text-left text-xs ${isDark ? 'text-white/70' : 'text-gray-600'}`}>\n                        Revenue\n                      </th>\n                      <th className={`px-6 py-3 text-left text-xs ${isDark ? 'text-white/70' : 'text-gray-600'}`}>\n                        Actions\n                      </th>\n                    </tr>\n                  </thead>\n                  <tbody className={`divide-y ${isDark ? 'divide-white/10' : 'divide-gray-200'}`}>\n                    {filteredUsers.map((user) => (\n                      <tr key={user.id} className={`transition-colors ${\n                        isDark ? 'hover:bg-white/5' : 'hover:bg-gray-50'\n                      }`}>\n                        <td className=\"px-6 py-4\">\n                          <div>\n                            <div className={`text-sm ${isDark ? 'text-white' : 'text-gray-900'}`}>\n                              {user.name}\n                            </div>\n                            <div className={`text-xs ${isDark ? 'text-white/50' : 'text-gray-500'}`}>\n                              {user.id}\n                            </div>\n                          </div>\n                        </td>\n                        <td className=\"px-6 py-4\">\n                          <div className=\"space-y-1\">\n                            <div className={`text-xs flex items-center gap-1 ${isDark ? 'text-white/70' : 'text-gray-600'}`}>\n                              <Mail className=\"w-3 h-3\" />\n                              {user.email}\n                            </div>\n                            <div className={`text-xs flex items-center gap-1 ${isDark ? 'text-white/70' : 'text-gray-600'}`}>\n                              <Phone className=\"w-3 h-3\" />\n                              {user.phone}\n                            </div>\n                          </div>\n                        </td>\n                        <td className=\"px-6 py-4\">\n                          <span className={`px-2 py-1 rounded-full text-xs ${\n                            user.subscription === 'Premium' \n                              ? isDark ? 'bg-purple-500/20 text-purple-400' : 'bg-purple-100 text-purple-700'\n                              : user.subscription === 'Basic'\n                              ? isDark ? 'bg-blue-500/20 text-blue-400' : 'bg-blue-100 text-blue-700'\n                              : isDark ? 'bg-gray-500/20 text-gray-400' : 'bg-gray-100 text-gray-700'\n                          }`}>\n                            {user.subscription}\n                          </span>\n                        </td>\n                        <td className=\"px-6 py-4\">\n                          <select\n                            value={user.role}\n                            onChange={(e) => console.log('Role change', e.target.value)}\n                            className={`text-xs px-2 py-1 rounded-lg border ${\n                              user.role === 'admin'\n                                ? isDark ? 'bg-orange-500/20 border-orange-500/30 text-orange-400' : 'bg-orange-100 border-orange-200 text-orange-700'\n                                : isDark ? 'bg-cyan-500/20 border-cyan-500/30 text-cyan-400' : 'bg-cyan-100 border-cyan-200 text-cyan-700'\n                            }`}\n                          >\n                            <option value=\"user\">User</option>\n                            <option value=\"admin\">Admin</option>\n                            <option value=\"moderator\">Moderator</option>\n                          </select>\n                        </td>\n                        <td className=\"px-6 py-4\">\n                          <span className={`px-2 py-1 rounded-full text-xs flex items-center gap-1 w-fit ${\n                            user.status === 'active' \n                              ? isDark ? 'bg-green-500/20 text-green-400' : 'bg-green-100 text-green-700'\n                              : user.status === 'suspended'\n                              ? isDark ? 'bg-red-500/20 text-red-400' : 'bg-red-100 text-red-700'\n                              : isDark ? 'bg-gray-500/20 text-gray-400' : 'bg-gray-100 text-gray-700'\n                          }`}>\n                            {user.status === 'active' && <CheckCircle className=\"w-3 h-3\" />}\n                            {user.status === 'suspended' && <Ban className=\"w-3 h-3\" />}\n                            {user.status === 'inactive' && <Clock className=\"w-3 h-3\" />}\n                            {user.status}\n                          </span>\n                        </td>\n                        <td className=\"px-6 py-4\">\n                          <div className=\"space-y-1\">\n                            <div className={`text-xs ${isDark ? 'text-white/70' : 'text-gray-600'}`}>\n                              {user.biomarkers} biomarkers\n                            </div>\n                            <div className={`text-xs ${isDark ? 'text-white/50' : 'text-gray-500'}`}>\n                              {user.aiQueries} AI queries\n                            </div>\n                          </div>\n                        </td>\n                        <td className=\"px-6 py-4\">\n                          <div className={`text-sm ${isDark ? 'text-white' : 'text-gray-900'}`}>\n                            ${user.revenue.toFixed(2)}\n                          </div>\n                        </td>\n                        <td className=\"px-6 py-4\">\n                          <div className=\"flex items-center gap-2\">\n                            <button \n                              onClick={() => setSelectedUser(user)}\n                              className={`p-1.5 rounded-lg transition-colors ${\n                                isDark ? 'hover:bg-white/10' : 'hover:bg-gray-200'\n                              }`} \n                              title=\"View Details\"\n                            >\n                              <Eye className={`w-4 h-4 ${isDark ? 'text-white/70' : 'text-gray-600'}`} />\n                            </button>\n                            <button className={`p-1.5 rounded-lg transition-colors ${\n                              isDark ? 'hover:bg-white/10' : 'hover:bg-gray-200'\n                            }`} title=\"More Options\">\n                              <Settings className={`w-4 h-4 ${isDark ? 'text-white/70' : 'text-gray-600'}`} />\n                            </button>\n                          </div>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            </div>

            <div className={`text-sm ${isDark ? 'text-white/50' : 'text-gray-500'}`}>\n              Showing {filteredUsers.length} of {MOCK_USERS.length} users\n            </div>\n          </div>\n        )}\n\n        {/* Other tabs would go here - I'll keep the rest from the original file */}\n      </div>\n\n      {/* User Detail Modal */}\n      {selectedUser && (\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center\">\n          <div \n            className=\"absolute inset-0 bg-black/60 backdrop-blur-sm\"\n            onClick={() => setSelectedUser(null)}\n          />\n          <div className={`relative w-full max-w-2xl mx-4 rounded-3xl overflow-hidden ${\n            isDark \n              ? 'bg-gradient-to-br from-slate-900 via-blue-950 to-slate-900' \n              : 'bg-gradient-to-br from-blue-50 via-teal-50 to-cyan-50'\n          }`}>\n            <div className={`p-6 border-b ${isDark ? 'border-white/10' : 'border-black/10'}`}>\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center gap-3\">\n                  <UserCheck className={`w-5 h-5 ${isDark ? 'text-cyan-400' : 'text-cyan-600'}`} />\n                  <h2 className={`text-lg ${isDark ? 'text-white' : 'text-gray-900'}`}>\n                    User Details\n                  </h2>\n                </div>\n                <button\n                  onClick={() => setSelectedUser(null)}\n                  className={`px-4 py-2 rounded-xl transition-colors ${\n                    isDark ? 'hover:bg-white/10 text-white/70' : 'hover:bg-black/5 text-gray-600'\n                  }`}\n                >\n                  Close\n                </button>\n              </div>\n            </div>\n            <div className=\"p-6 max-h-[70vh] overflow-y-auto\">\n              <div className=\"space-y-4\">\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <div className={`text-xs mb-1 ${isDark ? 'text-white/50' : 'text-gray-500'}`}>Name</div>\n                    <div className={`text-sm ${isDark ? 'text-white' : 'text-gray-900'}`}>{selectedUser.name}</div>\n                  </div>\n                  <div>\n                    <div className={`text-xs mb-1 ${isDark ? 'text-white/50' : 'text-gray-500'}`}>Email</div>\n                    <div className={`text-sm ${isDark ? 'text-white' : 'text-gray-900'}`}>{selectedUser.email}</div>\n                  </div>\n                  <div>\n                    <div className={`text-xs mb-1 ${isDark ? 'text-white/50' : 'text-gray-500'}`}>Phone</div>\n                    <div className={`text-sm ${isDark ? 'text-white' : 'text-gray-900'}`}>{selectedUser.phone}</div>\n                  </div>\n                  <div>\n                    <div className={`text-xs mb-1 ${isDark ? 'text-white/50' : 'text-gray-500'}`}>Joined</div>\n                    <div className={`text-sm ${isDark ? 'text-white' : 'text-gray-900'}`}>{selectedUser.joined}</div>\n                  </div>\n                  <div>\n                    <div className={`text-xs mb-1 ${isDark ? 'text-white/50' : 'text-gray-500'}`}>Last Active</div>\n                    <div className={`text-sm ${isDark ? 'text-white' : 'text-gray-900'}`}>{selectedUser.lastActive}</div>\n                  </div>\n                  <div>\n                    <div className={`text-xs mb-1 ${isDark ? 'text-white/50' : 'text-gray-500'}`}>Subscription</div>\n                    <div className={`text-sm ${isDark ? 'text-white' : 'text-gray-900'}`}>{selectedUser.subscription}</div>\n                  </div>\n                  <div>\n                    <div className={`text-xs mb-1 ${isDark ? 'text-white/50' : 'text-gray-500'}`}>Access Level</div>\n                    <div className={`text-sm ${isDark ? 'text-white' : 'text-gray-900'}`}>{selectedUser.role}</div>\n                  </div>\n                  <div>\n                    <div className={`text-xs mb-1 ${isDark ? 'text-white/50' : 'text-gray-500'}`}>Total Revenue</div>\n                    <div className={`text-sm ${isDark ? 'text-white' : 'text-gray-900'}`}>${selectedUser.revenue.toFixed(2)}</div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}
