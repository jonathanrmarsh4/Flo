{
  "role": "senior_ios_and_webview_engineer",
  "goal": "Eliminate the white strip visible at the top or bottom of the Flo iOS app when the user scrolls to the vertical limits. This is caused by iOS WKWebView rubber-band overscroll bounce exposing the default white background. Fully resolve it at the native (Capacitor iOS) and CSS levels without breaking app functionality.",
  "app_context": {
    "app_name": "Fl≈ç",
    "stack": {
      "frontend": "Replit-hosted web app (HTML/CSS/JS/React)",
      "mobile": "Capacitor iOS wrapper using WKWebView"
    },
    "symptom": "Scrolling to the very top or bottom reveals a white strip due to iOS WebView bounce."
  },
  "tasks": [
    {
      "id": "detect_capacitor_setup",
      "description": "Identify Capacitor version and iOS entry points.",
      "steps": [
        "Locate capacitor.config.ts/json/js.",
        "Check package.json for @capacitor/core version.",
        "Inspect ios/App/App/AppDelegate.swift.",
        "Determine if ios/App/App/SceneDelegate.swift exists.",
        "Identify where the root CAPBridgeViewController is created."
      ]
    },
    {
      "id": "disable_wkwebview_bounce",
      "description": "Disable WKWebView rubber-band overscroll bounce and apply correct background color.",
      "steps": [
        "In AppDelegate.swift (inside application:didFinishLaunchingWithOptions:), AFTER window/rootViewController setup, insert:",
        "IF USING ONLY AppDelegate.swift:",
        "```swift",
        "if let window = self.window {",
        "    if let nav = window.rootViewController as? UINavigationController,",
        "       let bridgeVC = nav.viewControllers.first as? CAPBridgeViewController {",
        "        let scrollView = bridgeVC.webView?.scrollView",
        "        scrollView?.bounces = false",
        "        scrollView?.alwaysBounceVertical = false",
        "        scrollView?.backgroundColor = .black",
        "        bridgeVC.webView?.isOpaque = false",
        "        bridgeVC.webView?.backgroundColor = .black",
        "    } else if let bridgeVC = window.rootViewController as? CAPBridgeViewController {",
        "        let scrollView = bridgeVC.webView?.scrollView",
        "        scrollView?.bounces = false",
        "        scrollView?.alwaysBounceVertical = false",
        "        scrollView?.backgroundColor = .black",
        "        bridgeVC.webView?.isOpaque = false",
        "        bridgeVC.webView?.backgroundColor = .black",
        "    }",
        "}",
        "```",
        "IF USING SceneDelegate.swift:",
        "Add the same logic after window?.makeKeyAndVisible().",
        "Ensure scrollView.bounces = false everywhere."
      ]
    },
    {
      "id": "capacitor_background_color",
      "description": "Set Capacitor's native WKWebView background color to match the app theme.",
      "steps": [
        "Open capacitor.config.ts/json.",
        "Add or update:",
        "```json",
        "\"ios\": { \"backgroundColor\": \"#0f172a\" }",
        "```",
        "Run: npx cap sync ios",
        "Rebuild in Xcode."
      ]
    },
    {
      "id": "global_css_cleanup",
      "description": "Ensure HTML/CSS backgrounds and overscroll behavior match native settings.",
      "steps": [
        "In global CSS (index.css / global.css), add:",
        "```css",
        "html, body {",
        "  margin: 0;",
        "  padding: 0;",
        "  width: 100%;",
        "  height: 100%;",
        "  background-color: #0f172a;",
        "  overscroll-behavior-y: none;",
        "}",
        "body {",
        "  -webkit-overflow-scrolling: touch;",
        "}",
        "#root, #app {",
        "  min-height: 100vh;",
        "  background-color: #0f172a;",
        "}",
        "```",
        "Ensure no global white backgrounds exist."
      ]
    },
    {
      "id": "test_and_verify",
      "description": "Verify the issue is resolved on simulator and device.",
      "steps": [
        "Run the app in Xcode.",
        "Scroll aggressively to top and bottom of all screens.",
        "Ensure NO white strip appears.",
        "Confirm scrolling remains smooth.",
        "Ensure fixed headers/footers still behave normally."
      ]
    }
  ],
  "files_to_modify": [
    "ios/App/App/AppDelegate.swift",
    "ios/App/App/SceneDelegate.swift (if exists)",
    "capacitor.config.ts or capacitor.config.json",
    "src/index.css or src/global.css",
    "Root container styles (#root / #app)"
  ],
  "definition_of_done": [
    "White strip at scroll limits no longer appears anywhere.",
    "WKWebView bounces are fully disabled or visually seamless.",
    "Background colors are consistent across native + web layers.",
    "All existing UI/UX continues to function normally.",
    "App builds with no new warnings or errors in Xcode."
  ]
}
